{"ast":null,"code":"const Collector = require('./interfaces/Collector');\n\nconst Collection = require('../util/Collection');\n/**\n * @typedef {CollectorOptions} ReactionCollectorOptions\n * @property {number} max The maximum total amount of reactions to collect\n * @property {number} maxEmojis The maximum number of emojis to collect\n * @property {number} maxUsers The maximum number of users to react\n */\n\n/**\n * Collects reactions on messages.\n * @extends {Collector}\n */\n\n\nclass ReactionCollector extends Collector {\n  /**\n   * @param {Message} message The message upon which to collect reactions\n   * @param {CollectorFilter} filter The filter to apply to this collector\n   * @param {ReactionCollectorOptions} [options={}] The options to apply to this collector\n   */\n  constructor(message, filter, options = {}) {\n    super(message.client, filter, options);\n    /**\n     * The message\n     * @type {Message}\n     */\n\n    this.message = message;\n    /**\n     * The users which have reacted\n     * @type {Collection}\n     */\n\n    this.users = new Collection();\n    /**\n     * The total number of reactions collected\n     * @type {number}\n     */\n\n    this.total = 0;\n    this.client.setMaxListeners(this.client.getMaxListeners() + 1);\n    this.client.on('messageReactionAdd', this.listener);\n  }\n  /**\n   * Handle an incoming reaction for possible collection.\n   * @param {MessageReaction} reaction The reaction to possibly collect\n   * @returns {?{key: Snowflake, value: MessageReaction}}\n   * @private\n   */\n\n\n  handle(reaction) {\n    if (reaction.message.id !== this.message.id) return null;\n    return {\n      key: reaction.emoji.id || reaction.emoji.name,\n      value: reaction\n    };\n  }\n  /**\n   * Check after collection to see if the collector is done.\n   * @param {MessageReaction} reaction The reaction that was collected\n   * @param {User} user The user that reacted\n   * @returns {?string} Reason to end the collector, if any\n   * @private\n   */\n\n\n  postCheck(reaction, user) {\n    this.users.set(user.id, user);\n    if (this.options.max && ++this.total >= this.options.max) return 'limit';\n    if (this.options.maxEmojis && this.collected.size >= this.options.maxEmojis) return 'emojiLimit';\n    if (this.options.maxUsers && this.users.size >= this.options.maxUsers) return 'userLimit';\n    return null;\n  }\n  /**\n   * Remove event listeners.\n   * @private\n   */\n\n\n  cleanup() {\n    this.client.removeListener('messageReactionAdd', this.listener);\n    this.client.setMaxListeners(this.client.getMaxListeners() - 1);\n  }\n\n}\n\nmodule.exports = ReactionCollector;","map":null,"metadata":{},"sourceType":"script"}