{"ast":null,"code":"const Action = require('./Action');\n\nconst Message = require('../../structures/Message');\n\nclass MessageCreateAction extends Action {\n  handle(data) {\n    const client = this.client;\n    const channel = client.channels.get((data instanceof Array ? data[0] : data).channel_id);\n    const user = client.users.get((data instanceof Array ? data[0] : data).author.id);\n\n    if (channel) {\n      const member = channel.guild ? channel.guild.member(user) : null;\n\n      if (data instanceof Array) {\n        const messages = new Array(data.length);\n\n        for (let i = 0; i < data.length; i++) {\n          messages[i] = channel._cacheMessage(new Message(channel, data[i], client));\n        }\n\n        const lastMessage = messages[messages.length - 1];\n        channel.lastMessageID = lastMessage.id;\n\n        if (user) {\n          user.lastMessageID = lastMessage.id;\n          user.lastMessage = lastMessage;\n        }\n\n        if (member) {\n          member.lastMessageID = lastMessage.id;\n          member.lastMessage = lastMessage;\n        }\n\n        return {\n          messages\n        };\n      } else {\n        const message = channel._cacheMessage(new Message(channel, data, client));\n\n        channel.lastMessageID = data.id;\n\n        if (user) {\n          user.lastMessageID = data.id;\n          user.lastMessage = message;\n        }\n\n        if (member) {\n          member.lastMessageID = data.id;\n          member.lastMessage = message;\n        }\n\n        return {\n          message\n        };\n      }\n    }\n\n    return {\n      message: null\n    };\n  }\n\n}\n\nmodule.exports = MessageCreateAction;","map":null,"metadata":{},"sourceType":"script"}