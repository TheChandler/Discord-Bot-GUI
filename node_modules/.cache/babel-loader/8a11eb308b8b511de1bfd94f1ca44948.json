{"ast":null,"code":"const Action = require('./Action');\n\nclass MessageDeleteAction extends Action {\n  constructor(client) {\n    super(client);\n    this.deleted = new Map();\n  }\n\n  handle(data) {\n    const client = this.client;\n    const channel = client.channels.get(data.channel_id);\n    let message;\n\n    if (channel) {\n      message = channel.messages.get(data.id);\n\n      if (message) {\n        channel.messages.delete(message.id);\n        this.deleted.set(channel.id + message.id, message);\n        this.scheduleForDeletion(channel.id, message.id);\n      } else {\n        message = this.deleted.get(channel.id + data.id) || null;\n      }\n\n      if (message) message.deleted = true;\n    }\n\n    return {\n      message\n    };\n  }\n\n  scheduleForDeletion(channelID, messageID) {\n    this.client.setTimeout(() => this.deleted.delete(channelID + messageID), this.client.options.restWsBridgeTimeout);\n  }\n\n}\n\nmodule.exports = MessageDeleteAction;","map":null,"metadata":{},"sourceType":"script"}